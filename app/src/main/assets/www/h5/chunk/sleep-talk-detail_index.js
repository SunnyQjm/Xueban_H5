(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"232":function(e,t,n){"use strict";var o=n(2),a=n(15),i=n(9);t.a={"dispatchPreviewQrCode":function dispatchPreviewQrCode(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(i){i({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_PREVIEW_QR_CODE,"data":{"content":e,"tip":t,"description":n}}),a.a.navigateTo(a.a.Pages.QrCodePreviewPage)}},"dispatchGotoCourseDetail":function dispatchGotoCourseDetail(e,t){return function(n){var i={"mode":e};0===e?i.courses=t:2===e&&(i.networkCourses=t),n({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_COURSE_DETAIL,"data":i}),a.a.navigateTo(a.a.Pages.CourseDetailPage)}},"dispatchGoToPostDetail":function dispatchGoToPostDetail(e){return function(t){t({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_POST_DETAIL,"data":e}),a.a.navigateTo(a.a.Pages.SleepTalkDetailPage,{"id":e.id})}},"dispatchGotoNoticeDetail":function dispatchGotoNoticeDetail(e){return function(t){t({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_NOTICE_DETAIL,"data":e}),a.a.navigateTo(a.a.Pages.StuNoticeDetailPage,{"id":e.id})}},"dispatchGoToPersonDetail":function dispatchGoToPersonDetail(e){return function(t){t({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_PERSON_DETAIL,"data":e}),a.a.navigateTo(a.a.Pages.PersonInfoPage,{"userId":e.id,"isOther":!i.a.userInfo||i.a.userInfo.id!==e.id})}},"dispatchPreviewImage":function dispatchPreviewImage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){n({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_PREVIEW_IMAGES,"data":{"urls":e,"index":t}}),a.a.navigateTo(a.a.Pages.ImagePreviewerPage)}}}},"547":function(e,t,n){},"621":function(e,t,n){"use strict";n.r(t);var o=n(3),a=n(230),i=n(596),l=n(17),c=n(27),r=n(13),p=n(9),s=n(2),u=n(232),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},h=d({},u.a,{"dispatchGetSleepTalkItemDetail":function dispatchGetSleepTalkItemDetail(e){return function(t){t({"type":s.a.GLOBAL.GET_POST_DETAIL_BEGIN}),p.a.getPost(e).then(function(e){t({"type":s.a.GLOBAL.GET_POST_DETAIL_SUCCESS,"data":{"post":e}})}).catch(function(e){console.log(e),t({"type":s.a.GLOBAL.GET_POST_DETAIL_FAIL})})}},"dispatchLikePost":function dispatchLikePost(e){return function(t){t({"type":s.a.GLOBAL.LIKE_POST_BEGIN}),p.a.likePost(e.id,e.isLiked?"del":"add").then(function(n){console.log(n),t({"type":s.a.GLOBAL.LIKE_POST_SUCCESS,"data":d({"post":e},n)})}).catch(function(e){console.log(e),t({"type":s.a.GLOBAL.LIKE_POST_FAIL})})}},"dispatchUpdatePost":function dispatchUpdatePost(e){return function(t){t({"type":s.a.GLOBAL.GET_POST_DETAIL_SUCCESS,"data":{"post":e}})}},"dispatchSendComment":function dispatchSendComment(e,t,n,o,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];return function(c){return new Promise(function(r,u){c({"type":s.a.GLOBAL.ADD_COMMENT_BEGIN}),p.a.addCommentToPost(t,n,o,l,a,i).then(function(t){c({"type":s.a.GLOBAL.ADD_COMMENT_SUCCESS,"data":d({},t,{"post":e})}),r(t)}).catch(function(e){console.log(e),c({"type":s.a.GLOBAL.ADD_COMMENT_FAIL}),u(e)})})}},"dispatchDelPost":function dispatchDelPost(e){return function(t){return new Promise(function(n,o){t({"type":s.a.GLOBAL.DEL_POST_BEGIN}),p.a.delPost(e.id).then(function(o){t({"type":s.a.GLOBAL.DEL_POST_SUCCESS,"data":d({"post":e},o)}),n(o)}).catch(function(e){console.log(e),t({"type":s.a.GLOBAL.DEL_POST_FAIL}),o(e)})})}},"dispatchCollectPost":function dispatchCollectPost(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add";return function(n){return new Promise(function(o,a){n({"type":s.a.GLOBAL.COLLECT_POST_BEGIN}),p.a.collectPost(e.id,t).then(function(t){n({"type":s.a.GLOBAL.COLLECT_POST_SUCCESS,"data":d({"post":e},t)}),o(t)}).catch(function(e){console.log(e),n({"type":s.a.GLOBAL.COLLECT_POST_FAIL}),a(e)})})}}}),P=n(231),m=n(20),f=n(15),O=(n(547),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}()),_=function get(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var a=Object.getPrototypeOf(e);return null===a?void 0:get(a,t,n)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(n):void 0},T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var C=function(e){function SleepTalkDetailPage(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SleepTalkDetailPage);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SleepTalkDetailPage.__proto__||Object.getPrototypeOf(SleepTalkDetailPage)).call(this,e));return t.config={},t.state={"sendComponentPlaceholder":"请输入评论"},t.handleOnMenuItemClick=t.handleOnMenuItemClick.bind(t),t.handleOnCommentClick=t.handleOnCommentClick.bind(t),t.handleSendComment=t.handleSendComment.bind(t),t.handleOnZanClick=t.handleOnZanClick.bind(t),t.handleOnImageClick=t.handleOnImageClick.bind(t),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SleepTalkDetailPage,m["a"]),O(SleepTalkDetailPage,[{"key":"componentWillMount","value":function componentWillMount(){var e=this.$router.params.id;e&&this.props.dispatchGetSleepTalkItemDetail(e)}},{"key":"handleOnZanClick","value":function handleOnZanClick(e){this.props.dispatchLikePost(e)}},{"key":"handleOnCommentClick","value":function handleOnCommentClick(e){this.clickComment=e,this.setState({"sendComponentPlaceholder":"回复 "+e.name})}},{"key":"handleSendComment","value":function handleSendComment(e){var t=this;if(e.value){var n=this.props.post;this.clickComment?this.props.dispatchSendComment(this.props.post,Number(this.clickComment.id),e.value,e.isAnonymous?1:0,this.clickComment.studentId,!1,[]).then(function(){t.clickComment=null,t.setState({"sendComponentPlaceholder":"请输入评论"}),n.id&&t.props.dispatchGetSleepTalkItemDetail(n.id)}):this.props.dispatchSendComment(this.props.post,Number(n.id),e.value,e.isAnonymous?1:0,n.StudentId,!0,[]).then(function(){n.id&&t.props.dispatchGetSleepTalkItemDetail(n.id)})}else m.a.waringMessage("请输入要发表的评论内容～")}},{"key":"handleOnMenuItemClick","value":function handleOnMenuItemClick(e){switch(e){case 0:this.$preload(s.a.PRELOAD.PRELOAD_SLEEP_TALK_REPORT_POST,this.props.post),f.a.navigateTo(f.a.Pages.SleepTalkReportPost);break;case 1:this.props.dispatchCollectPost(this.props.post).then(function(){m.a.successMessage("收藏成功")});break;case 2:this.props.dispatchDelPost(this.props.post).then(function(){f.a.navigateBack().then(function(){m.a.successMessage("删除成功")})})}}},{"key":"handleOnImageClick","value":function handleOnImageClick(e,t,n){this.previewImage(e,t,n)}},{"key":"render","value":function render(){var e=this,t=this.props,n=t.post,a=t.operatorMenuList,c=this.state.sendComponentPlaceholder;return o.e.createElement(i.a,null,o.e.createElement(l.a,{"className":"none"}),o.e.createElement(P.b,{"title":"帖子详情","leftIconVisible":!0}),o.e.createElement(P.j,{"fullScreen":!0},o.e.createElement(P.C,{"post":n,"onZanClick":this.handleOnZanClick,"onImageClick":this.handleOnImageClick}),n&&n.Comments&&n.Comments.map(function(t){return o.e.createElement(P.B,{"comment":t,"key":t.id,"onCommentClick":e.handleOnCommentClick},t.content)}),o.e.createElement(P.A,{"onConfirm":this.handleSendComment,"placeholder":c})),o.e.createElement(P.o,{"onMenuItemClick":this.handleOnMenuItemClick,"menuList":a,"verticalMargin":140}))}},{"key":"componentDidMount","value":function componentDidMount(){_(SleepTalkDetailPage.prototype.__proto__||Object.getPrototypeOf(SleepTalkDetailPage.prototype),"componentDidMount",this)&&_(SleepTalkDetailPage.prototype.__proto__||Object.getPrototypeOf(SleepTalkDetailPage.prototype),"componentDidMount",this).call(this)}},{"key":"componentDidShow","value":function componentDidShow(){_(SleepTalkDetailPage.prototype.__proto__||Object.getPrototypeOf(SleepTalkDetailPage.prototype),"componentDidShow",this)&&_(SleepTalkDetailPage.prototype.__proto__||Object.getPrototypeOf(SleepTalkDetailPage.prototype),"componentDidShow",this).call(this)}},{"key":"componentDidHide","value":function componentDidHide(){_(SleepTalkDetailPage.prototype.__proto__||Object.getPrototypeOf(SleepTalkDetailPage.prototype),"componentDidHide",this)&&_(SleepTalkDetailPage.prototype.__proto__||Object.getPrototypeOf(SleepTalkDetailPage.prototype),"componentDidHide",this).call(this)}}]),SleepTalkDetailPage}();C.defaultProps={"dispatchGetSleepTalkItemDetail":function dispatchGetSleepTalkItemDetail(){}},C=a.a([Object(c.b)(function mapStateToProps(e){return T({},e.SleepTalkDetailReducer.toJS())},function mapDispatchToProps(e){return T({},Object(r.b)(h,e))})],C);t.default=C}}]);