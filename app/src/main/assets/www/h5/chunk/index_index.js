(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"232":function(e,t,n){"use strict";var o=n(2),a=n(15),i=n(9);t.a={"dispatchPreviewQrCode":function dispatchPreviewQrCode(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(i){i({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_PREVIEW_QR_CODE,"data":{"content":e,"tip":t,"description":n}}),a.a.navigateTo(a.a.Pages.QrCodePreviewPage)}},"dispatchGotoCourseDetail":function dispatchGotoCourseDetail(e,t){return function(n){var i={"mode":e};0===e?i.courses=t:2===e&&(i.networkCourses=t),n({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_COURSE_DETAIL,"data":i}),a.a.navigateTo(a.a.Pages.CourseDetailPage)}},"dispatchGoToPostDetail":function dispatchGoToPostDetail(e){return function(t){t({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_POST_DETAIL,"data":e}),a.a.navigateTo(a.a.Pages.SleepTalkDetailPage,{"id":e.id})}},"dispatchGotoNoticeDetail":function dispatchGotoNoticeDetail(e){return function(t){t({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_NOTICE_DETAIL,"data":e}),a.a.navigateTo(a.a.Pages.StuNoticeDetailPage,{"id":e.id})}},"dispatchGoToPersonDetail":function dispatchGoToPersonDetail(e){return function(t){t({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_PERSON_DETAIL,"data":e}),a.a.navigateTo(a.a.Pages.PersonInfoPage,{"userId":e.id,"isOther":!i.a.userInfo||i.a.userInfo.id!==e.id})}},"dispatchPreviewImage":function dispatchPreviewImage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){n({"type":o.a.ROUTER_PARAM.ROUTER_PARAM_PREVIEW_IMAGES,"data":{"urls":e,"index":t}}),a.a.navigateTo(a.a.Pages.ImagePreviewerPage)}}}},"500":function(e,t,n){},"610":function(e,t,n){"use strict";n.r(t);var o,a=n(3),i=n(230),s=n(609),c=n(1),r=Object(c.g)("scanQRCode",{"needResult":1},function(e){return{"errMsg":"scanQRCode:ok"===e.errMsg?"scanCode:ok":e.errMsg,"result":e.resultStr}}),l=n(17),u=n(27),f=n(13),d=n(20),p=(n(500),n(231)),h=n(229),g=n(9),C=n(232),I=(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e})({},C.a,{"dispatchGetClassInfo":function dispatchGetClassInfo(e,t){return function(n){return g.a.getClassInfo(e,t,n)}}}),P=n(15),m=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var k=o=function(e){function IndexPage(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,IndexPage);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(IndexPage.__proto__||Object.getPrototypeOf(IndexPage)).call(this,e));return t.config={"usingComponents":{}},t.state={"tabIndex":0,"title":"第五周","leftIconVisible":!0,"showDropDownImage":!0,"leftIcon":h.a.Images.icon_table_scan},t.handleOnCourseItemClick=t.handleOnCourseItemClick.bind(t),t.handleOnLeftIconClick=t.handleOnLeftIconClick.bind(t),t.handleOnTitleClick=t.handleOnTitleClick.bind(t),t.xbFloatBtnRefCat=t.xbFloatBtnRefCat.bind(t),t.onMenuItemClick=t.onMenuItemClick.bind(t),t.dealScanResult=t.dealScanResult.bind(t),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(IndexPage,d["a"]),m(IndexPage,[{"key":"componentWillMount","value":function componentWillMount(){}},{"key":"componentDidMount","value":function componentDidMount(){this.props.dispatchGetClassInfo(!1,!1)}},{"key":"componentWillUnmount","value":function componentWillUnmount(){}},{"key":"componentDidShow","value":function componentDidShow(){}},{"key":"componentDidHide","value":function componentDidHide(){}},{"key":"dealScanResult","value":function dealScanResult(e){var t=this,n=e.result.split("/")[2].split("&"),o=n[0],a=n[1];g.a.getCourseInfoByIdAndNumber(o,a).then(function(e){var n=e.course;Object(s.c)({"title":"添加课程","content":"确定添加 "+n.Name+"("+n.CourseNumber+")","success":function success(e){e.confirm&&g.a.addCustomCourseInfo(n,t.props.dispatch).then(function(){d.a.successMessage("扫码添加课程: "+n.Name+" 成功！")}).catch(function(e){d.a.errorMessage(e)})}})}).catch(function(e){d.a.errorMessage(e),console.log(e)})}},{"key":"handleOnLeftIconClick","value":function handleOnLeftIconClick(){var e=this;if(d.a.isWeapp())r().then(function(t){e.dealScanResult(t)}).catch(function(e){d.a.errorMessage(e.message)});else if(d.a.isH5())try{r().then(function(t){e.dealScanResult(t)}).catch(function(e){d.a.errorMessage(e.message)})}catch(e){d.a.waringMessage("h5端仅在微信公众号中支持扫码功能～")}}},{"key":"onMenuItemClick","value":function onMenuItemClick(e){switch(e){case 0:this.props.dispatchGetClassInfo(!0,!1).then(function(){d.a.successMessage("成功同步教务课程表")}).catch(function(e){console.error(e)});break;case 1:P.a.navigateTo(P.a.Pages.CustomAddCoursePage);break;case 2:P.a.navigateTo(P.a.Pages.CourseDetailPage,{"mode":1})}}},{"key":"xbFloatBtnRefCat","value":function xbFloatBtnRefCat(e){this.xbFloatBtnMenu=e}},{"key":"handleOnCourseItemClick","value":function handleOnCourseItemClick(e){e.length<=0||e[0].empty||this.props.dispatchGotoCourseDetail(0,e)}},{"key":"handleOnTitleClick","value":function handleOnTitleClick(){P.a.navigateTo(P.a.Pages.ChangeWeekPage)}},{"key":"render","value":function render(){var e=h.a.Images.logo_header,t=40;return d.a.isH5()&&(t=140),a.e.createElement(l.a,{"className":"index"},a.e.createElement(p.b,{"title":"第 "+this.props.selectedWeek+" 周","showTitleDropDownIcon":this.state.showDropDownImage,"leftIcon":this.state.leftIcon,"leftIconVisible":this.state.leftIconVisible,"onLeftIconClick":this.handleOnLeftIconClick,"onTitleClick":this.handleOnTitleClick}),a.e.createElement(p.j,{"showLoading":this.props.showLoading},a.e.createElement(p.f,{"courseInfos":this.props.courseInfo,"week":this.props.week,"selectedWeek":this.props.selectedWeek,"test":this.props.courseInfo.length,"onCourseItemClick":this.handleOnCourseItemClick}),a.e.createElement(p.o,{"iconSize":50,"btnSize":90,"icon":e,"menuList":o.menuList,"onMenuItemClick":this.onMenuItemClick,"verticalMargin":t,"ref":this.xbFloatBtnRefCat})))}}]),IndexPage}();k.defaultProps={"selectedWeek":1,"week":1,"dispatchGetClassInfo":function dispatchGetClassInfo(){},"courseInfo":[],"showLoading":!1,"dispatch":null},k.menuList=["自动添加","手动添加","全部课程"],k=o=i.a([Object(u.b)(function mapStateToProps(e){return R({},e.IndexReducer.toJS())},function mapDispatchToProps(e){return R({},Object(f.b)(I,e))})],k);t.default=k}}]);